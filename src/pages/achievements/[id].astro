---
import { AchievementSheet } from "../../components/AchievementSheet";
import "../../styles/globals.css"; 

export const prerender = false; // これでSSRを有効化

const { id } = Astro.params;

// ページごとのデータを取得
const response = await fetch(`http://localhost:4321/api/achievements/${id}`);

// エラーハンドリング
if (!response.ok) {
  throw new Error(`Achievement with ID "${id}" not found.`);
}

// 成功した場合はデータをJSONとしてパース
const achievement = await response.json();

// デバッグ用ログ
---

<html>
  <head>
    <meta charset="UTF-8" /> <!-- 文字化け防止のためにエンコーディングを指定 -->
    <title>Achievement: {achievement.data.student_name}</title>
  </head>
  <body>
    <div id="app">
      <!-- Reactコンポーネントをここに挿入 -->
      <AchievementSheet data={achievement.data} />
    </div>
  </body>
</html>